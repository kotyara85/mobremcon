
<html>
<head>
	<title>Slite Pitch Deck</title>

	<!-- Video Chat files -->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
		<link rel="stylesheet" href="../css/videochat/videochat-style.css">


	    <!-- slider JS files -->

    <script src="../js/jquery-1.8.3.js"></script>
    <script src="../js/jquery-ui-1.8.22.custom.min.js"></script>
    <script class="rs-file" src="../js/jquery.royalslider.min.js"></script>
    <script src="../js/jquery.infinitescroll.js"></script>
    <script src="http://slite-dev.elasticbeanstalk.com:1337/socket.io/socket.io.js"></script>

    <!-- Lev: This script controls the laser dot -->
    <script defer src="../js/LASER_RECEIVER.js"></script>

    <!-- this is for resizing the presentation when it appears in the iframe in the remote-->
    <!--<script type="text/javascript" defer src="./js/squeezeFrame.js"></script>
    <script type="text/javascript">
      myContainer="index.html";
      myMax=0.4;
      myRedraw="both";
    </script>-->


    <link href="../css/jquery-ui-1.8.22.custom.css" rel="stylesheet">
    <link class="rs-file" href="../css/royalslider.css" rel="stylesheet">

	<link rel="stylesheet" type="text/css" href="../css/index1.css">

	<script>

    var socket = io.connect('http://slite-dev.elasticbeanstalk.com:1337');
    //var socket = io.connect('http://localhost:1337');

    socket.on('ccBroadcast', function (data) {
    		//alert("JD: ccBroadcast text="+data.hello);
    		$('#closedCaptioningPanel').hide();
    		$('#closedCaptioningPanel').html( data.hello );
    		$('#closedCaptioningPanel').show(400).delay(2000).fadeOut(400);
    });

    socket.on('news', function (data) {

      var button = data.hello-1;

      console.log(button);

      var slider = $(".royalSlider").data('royalSlider');

      slider.goTo(data.slide);

      switch(button)
      {
        case -102: {
          slider.goTo(0);
          break;
        }
        case -1: {
          slider.toggleVideo();
          break;
        }
        case 100: {
          slider.next();
          clearCanvas();
          break;
        }
        case 101: {
          slider.prev();
          clearCanvas();
          break;
        }
        default: {
          slider.stopVideo();
          slider.goTo(button);
          slider.playVideo();
        }
      }

      socket.emit('my other event', { my: 'data' });
    });


	function showHideComments(){
		$("#comments").slideToggle();
	}

	var isVideoOn = false;
	function showHideVideoChat(){
		if(!isVideoOn)
		{
			if ( $( "#join-button" ).length ) {
				$( "#join-button" ).trigger( "click" );
			}else{
				$( "#setup-new-room" ).trigger( "click" );
			}
			isVideoOn = true;
		}
		$("#videochat").slideToggle();
		/*
		$("#videochat").css('overflow-x','hidden');
		$("#videochat").css('overflow-y','scroll');
		*/
	}

	</script>


    <!-- syntax highlighter -->
    <script src="../js/highlight.pack.js"></script>
    <script> hljs.initHighlightingOnLoad();</script>




    <!-- preview-related stylesheets -->
    <link href="../css/reset.css" rel="stylesheet">
    <link href="../css/github.css" rel="stylesheet">

    <!-- slider stylesheets -->


    <link class="rs-file" href="../css/rs-default.css" rel="stylesheet">


	<style>


		body{
			/* background-color:rgba(0,0,255,0.3); */
		}

		#video-gallery {
      position: absolute;
      z-index: 0;
		  width: 100%;
		}

		.videoGallery .rsTmb {
		  padding: 20px;
		}
		.videoGallery .rsThumbs .rsThumb {
		  width: 220px;
		  height: 80px;
		  border-bottom: 1px solid #2E2E2E;
		}
		.videoGallery .rsThumbs {
		  width: 220px;
		  padding: 0;
		}
		.videoGallery .rsThumb:hover {
		  background: #000;
		}
		.videoGallery .rsThumb.rsNavSelected {
		  background-color: #02874A;
		  border-bottom:-color #02874A;
		}

		.sampleBlock {
		  left: 3%;
		  top: 1%;
		  width: 100%;
		  max-width: 400px;
		}


		@media screen and (min-width: 0px) and (max-width: 600px) {
			  .videoGallery .rsTmb {
				padding: 6px 8px;
			  }
			  .videoGallery .rsTmb h5 {
				font-size: 12px;
				line-height: 17px;
			  }
			  .videoGallery .rsThumbs.rsThumbsVer {
				width: 100px;
				padding: 0;
			  }
			  .videoGallery .rsThumbs .rsThumb {
				width: 100px;
				height: 47px;
			  }
			  .videoGallery .rsTmb span {
				display: none;
			  }
			  .videoGallery .rsOverflow,
			  .royalSlider.videoGallery {
				height: 300px !important;
			  }
			  .sampleBlock {
				font-size: 14px;
			  }
			.royalSlider .rsSlide {
				opacity: 0.45;
				-webkit-transition: all 0.3s ease-out;
				-moz-transition: all 0.3s ease-out;
				transition: all 0.3s ease-out;

				-webkit-transform: scale(0.9);
				-moz-transform: scale(0.9);
				-ms-transform: scale(0.9);
				-o-transform: scale(0.9);
				transform: scale(0.9);
			}
			.royalSlider .rsActiveSlide {
				opacity: 1;
				-webkit-transform: scale(1);
				-moz-transform: scale(1);
				-ms-transform: scale(1);
				-o-transform: scale(1);
				transform: scale(1);
			}
		}

		#sliteWatermak{
			position: fixed;
			right: 20px;
			top: 0px;
			opacity: 0.4;
			filter: alpha(opacity=40);
			z-index: 2;
		}

	    #redDot {
	      /* the width is set to a small value so when the dot moves it will
	         not create a horizontal scroll bar. */
	      width: 2%;
	      overflow: hidden;
        visibility: hidden;
	      position: absolute;
	      left:0px;
	      top:0px;
	      z-index: 2;
	    }

	    #drawCanvas {
	      position: absolute;
	      border: none;
	      z-index: 1;
	      pointer-events: none;
	    }

		#videochat{
	    	position: absolute;
	    	left: 0px;
	    	width: 20%;
	    	height: 100vh;
	    	display: none;
			margin-left: 10px;
	    	background-color: #444444;
  			background-image: -webkit-linear-gradient(top, #444444, #999999); /* Chrome 10-25, iOS 5+, Safari 5.1+ */
  			background-image: linear-gradient(to bottom, #444444, #999999); /* Chrome 26, Firefox 16+, IE 10+, Opera */
			opacity: 0.93;
			font-size: 40px;
			font-weight: bold;
			color: white;
			line-height: normal;
			overflow-x: hidden;
			overflow-y: scroll;
		}

		#videochatpanel{
	    	position: fixed;
	    	left: 0px;
	    	width: 10px;
	    	height: 100vh;
	    	background-color: #444444;
  			background-image: -webkit-linear-gradient(top, #444444, #999999); /* Chrome 10-25, iOS 5+, Safari 5.1+ */
  			background-image: linear-gradient(to bottom, #444444, #999999); /* Chrome 26, Firefox 16+, IE 10+, Opera */
		}

	    #comments{
	    	position: absolute;
	    	bottom: 0px;
			right: 0px
	    	width: 100%;
	    	height: 500px;
	    	display: none;
	    }

	    #commentsPanel{
	    	position: fixed;
	    	bottom: 0px;
	    	width: 100%;
	    	height: 15px;
	    	 background-color: #444444;
  			background-image: -webkit-linear-gradient(top, #444444, #999999); /* Chrome 10-25, iOS 5+, Safari 5.1+ */
  			background-image: linear-gradient(to bottom, #444444, #999999); /* Chrome 26, Firefox 16+, IE 10+, Opera */
	    }

	    #HCB_comment_box{
	    	height: 100%;
	    	border-width: 1px;
	    	border-style: dotted;
	    }

	    iframe * img{
	    	width: 100%;
	    }


		/* VideoChat  */

		audio, video {
                -moz-transition: all 1s ease;
                -ms-transition: all 1s ease;

                -o-transition: all 1s ease;
                -webkit-transition: all 1s ease;
                transition: all 1s ease;
                vertical-align: top;
            }

            input {
                border: 1px solid #d9d9d9;
                border-radius: 1px;
                font-size: 2em;
                margin: .2em;
                width: 30%;
            }

            .setup {
                border-bottom-left-radius: 0;
                border-top-left-radius: 0;
                font-size: 102%;
                height: 47px;
                margin-left: -9px;
                margin-top: 8px;
                position: absolute;
            }

            p { padding: 1em; }

            li {
                border-bottom: 1px solid rgb(189, 189, 189);
                border-left: 1px solid rgb(189, 189, 189);
                padding: .5em;
            }

			#chatTop{
				display: none;
			}

			#rooms-list{
				display: none;
			}

			.experiment{
				border-style: none;
			}

			#closedCaptioningPanel{
				position: fixed;
				bottom: 5%;
				background-color: black;
				color: white;
				width: 100%;
				text-align: center;
				font-size: 40px;
				line-height: 40px;
			}

	</style>


	<!-- VideoChat Javascript -->
	<script>
            document.createElement('article');
            document.createElement('footer');
        </script>

        <!-- scripts used for video-conferencing -->
        <script src="../js/videochat/firebase.js"> </script>
        <script src="../js/videochat/RTCPeerConnection-v1.5.js"> </script>
        <script src="../js/videochat/conference.js"> </script>

        <!-- script used to stylize video element -->
        <script src="../js/videochat/getMediaElement.js"> </script>

		<script>
/*
			$(window).load(function() {
				window.setTimeout(function(){
					if ( $( "#join-button" ).length ) {
						$( "#join-button" ).trigger( "click" );
					}else{
						$( "#setup-new-room" ).trigger( "click" );
					}

					}, 1500);
			});
			*/
		</script>
	<!-- end VideoChat Javascript -->


</head>

<body onresize="resizeCanvas()">

    <canvas id="drawCanvas" ></canvas>

	<div id="sliteWatermak">Powered by SLITE.US</div>

    <div id="redDot"><img src="../img/redDot.png" alt="Laser Pointer"></div>

  	<div id="video-gallery" class="royalSlider videoGallery rsDefault"></div>

	<div id="comments">
			<!-- Begin Comments JavaScript Code --><script type="text/javascript" async>function ajaxpath_5434a641072d9(url){return window.location.href == '' ? url : url.replace('&s=','&s=' + escape(window.location.href));}(function(){document.write('<div id="fcs_div_5434a641072d9"><a title="free comment script" href="http://www.freecommentscript.com">&nbsp;&nbsp;<b>Free HTML User Comments</b>...</a></div>');fcs_5434a641072d9=document.createElement('script');fcs_5434a641072d9.type="text/javascript";fcs_5434a641072d9.src=ajaxpath_5434a641072d9("http://www.freecommentscript.com/GetComments2.php?p=5434a641072d9&s=&Size=10#!5434a641072d9");setTimeout("document.getElementById('fcs_div_5434a641072d9').appendChild(fcs_5434a641072d9)",1);})();</script><noscript><div><a href="http://www.freecommentscript.com" title="free html user comment box">Free Comment Script</a></div></noscript><!-- End Comments JavaScript Code -->
	</div>

	<div id="closedCaptioningPanel"></div>

	<div id="commentsPanel"></div>

	<div id="videochatpanel"></div>
	<div id="videochat" style="overflow-x: hidden; overflow-y: scroll;">

	<h1>Video Chat</h1>

	<article id="videochatMainContainer">

		<!-- just copy this <section> and next script -->
		<section class="experiment">
			<section id="chatTop">
				<span>
					Private ?? <a href="/video-conferencing/" target="_blank" title="Open this link in new tab. Then your conference room will be private!"><code><strong id="unique-token">#123456789</strong></code></a>
				</span>

				<input type="text" id="conference-name">
				<button id="setup-new-room" class="setup">Setup New Conference</button>
			</section>

			<!-- list of all available conferencing rooms -->
			<table style="width: 100%;" id="rooms-list"></table>

			<!-- local/remote videos container -->
			<div id="videos-container"></div>
		</section>

		<script>
			// Muaz Khan     - https://github.com/muaz-khan
			// MIT License   - https://www.webrtc-experiment.com/licence/
			// Documentation - https://github.com/muaz-khan/WebRTC-Experiment/tree/master/video-conferencing

			var _channelHash = "9WDXH6OH-6K73NMI";
			var config = {
				openSocket: function(config) {
					var channel = config.channel || location.href.replace( /\/|:|#|%|\.|\[|\]/g , '');
					channel += _channelHash;
					var socket = new Firebase('https://chat.firebaseIO.com/' + channel);
					socket.channel = channel;
					socket.on("child_added", function(data) {
						config.onmessage && config.onmessage(data.val());
					});
					socket.send = function(data) {
						this.push(data);
					};
					config.onopen && setTimeout(config.onopen, 1);
					socket.onDisconnect().remove();
					return socket;
				},
				onRemoteStream: function(media) {
					var mediaElement = getMediaElement(media.video, {
						width: (videosContainer.clientWidth / 2) - 50,
						buttons: ['mute-audio', 'mute-video', 'full-screen', 'volume-slider']
					});
					mediaElement.id = media.streamid;
					videosContainer.insertBefore(mediaElement, videosContainer.firstChild);
				},
				onRemoteStreamEnded: function(stream, video) {
					if (video.parentNode && video.parentNode.parentNode && video.parentNode.parentNode.parentNode) {
						video.parentNode.parentNode.parentNode.removeChild(video.parentNode.parentNode);
					}
				},
				onRoomFound: function(room) {
					var alreadyExist = document.querySelector('button[data-broadcaster="' + room.broadcaster + '"]');
					if (alreadyExist) {
						return;
					}

					if (typeof roomsList === 'undefined') roomsList = document.body;

					var tr = document.createElement('tr');
					tr.innerHTML = '<td><strong>' + room.roomName + '</strong> shared a conferencing room with you!</td>' +
						'<td><button id="join-button" class="join">Join</button></td>';
					roomsList.insertBefore(tr, roomsList.firstChild);

					var joinRoomButton = tr.querySelector('.join');
					joinRoomButton.setAttribute('data-broadcaster', room.broadcaster);
					joinRoomButton.setAttribute('data-roomToken', room.roomToken);
					joinRoomButton.onclick = function() {
						this.disabled = true;

						var broadcaster = this.getAttribute('data-broadcaster');
						var roomToken = this.getAttribute('data-roomToken');
						captureUserMedia(function() {
							conferenceUI.joinRoom({
								roomToken: roomToken,
								joinUser: broadcaster
							});
						}, function() {
							joinRoomButton.disabled = false;
						});
					};
				},
				onRoomClosed: function(room) {
					var joinButton = document.querySelector('button[data-roomToken="' + room.roomToken + '"]');
					if (joinButton) {
						// joinButton.parentNode === <li>
						// joinButton.parentNode.parentNode === <td>
						// joinButton.parentNode.parentNode.parentNode === <tr>
						// joinButton.parentNode.parentNode.parentNode.parentNode === <table>
						joinButton.parentNode.parentNode.parentNode.parentNode.removeChild(joinButton.parentNode.parentNode.parentNode);
					}
				}
			};

			function setupNewRoomButtonClickHandler() {
				btnSetupNewRoom.disabled = true;
				document.getElementById('conference-name').disabled = true;
				captureUserMedia(function() {
					conferenceUI.createRoom({
						roomName: (document.getElementById('conference-name') || { }).value || 'Anonymous'
					});
				}, function() {
					btnSetupNewRoom.disabled = document.getElementById('conference-name').disabled = false;
				});
			}

			function captureUserMedia(callback, failure_callback) {
				var video = document.createElement('video');

				getUserMedia({
					video: video,
					onsuccess: function(stream) {
						config.attachStream = stream;
						callback && callback();

						video.setAttribute('muted', true);

						var mediaElement = getMediaElement(video, {
							width: (videosContainer.clientWidth / 2) - 50,
							buttons: ['mute-audio', 'mute-video', 'full-screen', 'volume-slider']
						});
						mediaElement.toggle('mute-audio');
						videosContainer.insertBefore(mediaElement, videosContainer.firstChild);
					},
					onerror: function() {
						alert('unable to get access to your webcam');
						callback && callback();
					}
				});
			}

			var conferenceUI = conference(config);

			/* UI specific */
			var videosContainer = document.getElementById('videos-container') || document.body;
			var btnSetupNewRoom = document.getElementById('setup-new-room');
			var roomsList = document.getElementById('rooms-list');

			if (btnSetupNewRoom) btnSetupNewRoom.onclick = setupNewRoomButtonClickHandler;

			function rotateVideo(video) {
				video.style[navigator.mozGetUserMedia ? 'transform' : '-webkit-transform'] = 'rotate(0deg)';
				setTimeout(function() {
					video.style[navigator.mozGetUserMedia ? 'transform' : '-webkit-transform'] = 'rotate(360deg)';
				}, 1000);
			}

			(function() {
				var uniqueToken = document.getElementById('unique-token');
				if (uniqueToken)
					//if (location.hash.length > 2)
					uniqueToken.parentNode.parentNode.parentNode.innerHTML = '<h2 style="text-align:center;"><a href="' + location.href + "#" + _channelHash + '" target="_blank">Share this link</a></h2>';
					//else uniqueToken.innerHTML = uniqueToken.parentNode.parentNode.href = '#' + (Math.random() * new Date().getTime()).toString(36).toUpperCase().replace( /\./g , '-');
			})();

			function scaleVideos() {
				var videos = document.querySelectorAll('video'),
					length = videos.length, video;

				var minus = 130;
				var windowHeight = 700;
				var windowWidth = 600;
				var windowAspectRatio = windowWidth / windowHeight;
				var videoAspectRatio = 4 / 3;
				var blockAspectRatio;
				var tempVideoWidth = 0;
				var maxVideoWidth = 0;

				for (var i = length; i > 0; i--) {
					blockAspectRatio = i * videoAspectRatio / Math.ceil(length / i);
					if (blockAspectRatio <= windowAspectRatio) {
						tempVideoWidth = videoAspectRatio * windowHeight / Math.ceil(length / i);
					} else {
						tempVideoWidth = windowWidth / i;
					}
					if (tempVideoWidth > maxVideoWidth)
						maxVideoWidth = tempVideoWidth;
				}
				for (var i = 0; i < length; i++) {
					video = videos[i];
					if (video)
						video.width = maxVideoWidth - minus;
				}
			}

			window.onresize = scaleVideos;

		</script>



	</article>

	</div>

	<script>
		jQuery(document).ready(function($) {
				  $('#video-gallery').royalSlider({
					arrowsNav: false,
					fadeinLoadedSlide: true,
					controlNavigationSpacing: 0,
					controlNavigation: 'none',

					thumbs: {
					  autoCenter: false,
					  fitInViewport: true,
					  orientation: 'vertical',
					  spacing: 0,
					  paddingBottom: 0
					},
					keyboardNavEnabled: true,
					imageScaleMode: 'fill',
					imageAlignCenter:true,
					slidesSpacing: 0,
					loop: false,
					loopRewind: true,
					numImagesToPreload: 3,
					video: {
					  autoHideArrows:true,
					  autoHideControlNav:false,
					  autoHideBlocks: true
					},
					autoScaleSlider: true,
					autoScaleSliderWidth: 200,
					autoScaleSliderHeight: 100,
					visibleNearby: {
						enabled: false,
						centerArea: 0.5,
						center: true,
						breakpoint: 650,
						breakpointCenterArea: 0.64,
						navigateByCenterClick: true
					}
				  });
					for (var slide = 0; slide <= NUM_SLIDES; ++slide) {
						//var slide_html_path= "C:\\Users\\marov\\Documents\\GitHub\\mobremcon\\BACKEND\\TEST\\MA\\SliteShow_PitchDeck.pptx.html\\";
						//var slide_html_path = data.filename;
						var slide_html_path = "img"+slide+".html" + "?ts=" +  (new Date().getTime()); //slide url with added time stamp to stop caching
						var slide_html= "<div style='text-align:center' id=slide class='rsContent'>"
							+ "<iframe src='"+slide_html_path+"' width='100%' height='100%' seamless> </iframe>"
							+ "<div class='rsTmb'>"
							+ "<h5>SLIDE"+slide+"</h5>"
							+ "     <span>Slide "+slide+" here</span>"
							+ "</div> </div>";

						var slider = $(".royalSlider").data('royalSlider');
						slider.appendSlide(slide_html);
					}


					$("#video-gallery").css("height","100%");
					$(".rsOverflow").css("height","100%");
			});



	$('#commentsPanel').click(function(){
		showHideComments();
	});
	$('#videochatpanel').click(function(){
		showHideVideoChat();
	});

	</script>



</body>


</html>
